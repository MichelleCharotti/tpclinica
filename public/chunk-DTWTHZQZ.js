import{a as F,b as H}from"./chunk-4X2OL3FX.js";import{a as L}from"./chunk-4BMBXJ76.js";import{a as j}from"./chunk-VP4YQ6D5.js";import{$ as D,A as n,B as v,F as m,G as s,I as o,J as a,K as _,L as x,M as g,N as c,S as l,T as p,U as E,_ as S,aa as y,ba as I,bb as O,cb as P,la as U,m as h,ma as k,na as T,qa as w,r as u,s as f,v as C,y as b,ya as M}from"./chunk-ZKOOGIRO.js";var B=t=>({activo:t});function R(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"Nombre"),a(),o(3,"p"),l(4),a()()),t&2){let e=c();n(4),p(e.nombre)}}function z(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"Apellido"),a(),o(3,"p"),l(4),a()()),t&2){let e=c();n(4),p(e.apellido)}}function W(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"DNI"),a(),o(3,"p"),l(4),y(5,"dniFormato"),a()()),t&2){let e=c();n(4),p(I(5,1,e.dni))}}function $(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"Tipo"),a(),o(3,"p"),l(4),a()()),t&2){let e=c();n(4),p(e.tipo)}}function q(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"Edad"),a(),o(3,"p"),l(4),a()()),t&2){let e=c();n(4),p(e.edad)}}function G(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"Email"),a(),o(3,"p"),l(4),a()()),t&2){let e=c();n(4),p(e.email)}}function J(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"Obra Social"),a(),o(3,"p"),l(4),a()()),t&2){let e=c();n(4),p(e.obraSocial)}}function K(t,i){if(t&1&&(o(0,"p"),l(1),a()),t&2){let e=i.$implicit;n(),p(e)}}function Q(t,i){if(t&1&&(o(0,"div")(1,"label",6),l(2,"Especialidades"),a(),m(3,K,2,1,"p",7),a()),t&2){let e=c();n(3),s("ngForOf",e.especialidades)}}function Y(t,i){if(t&1&&(o(0,"div")(1,"label"),l(2,"Habilitado"),a(),_(3,"p",8),a()),t&2){let e=c();n(3),s("textContent",e.habilitado?"SI":"NO")}}function Z(t,i){if(t&1&&(o(0,"div",9)(1,"label",10),l(2,"Foto Perfil"),a(),_(3,"img",11),a()),t&2){let e=c();n(3),s("src",e.imagen1,b)}}function ee(t,i){if(t&1&&(o(0,"div",9)(1,"label",10),l(2,"Foto Alt"),a(),_(3,"img",12),a()),t&2){let e=c();n(3),s("src",e.imagen2,b)}}function te(t,i){if(t&1){let e=x();o(0,"button",13),g("click",function(){u(e);let d=c();return f(d.cambiarEstado())}),l(1),a()}if(t&2){let e=c();s("disabled",e.cargando)("ngClass",D(3,B,e.habilitado)),n(),E(" ",e.mensaje,` Especialista
`)}}function ie(t,i){if(t&1){let e=x();o(0,"button",14),g("click",function(){u(e);let d=c();return f(d.mostrarHistoriaClinica())}),l(1,` Mostrar Historia Clinica
`),a()}if(t&2){let e=c();s("disabled",e.cargando)}}function ae(t,i){if(t&1){let e=x();o(0,"button",15),g("click",function(){u(e);let d=c();return f(d.descargarDatosTurnos())}),l(1,` Descargar Datos Turnos
`),a()}if(t&2){let e=c();s("disabled",e.cargando)}}var A=class t{constructor(i,e){this.db=i;this.permisos=e}_usuario;cargando=!1;mensajeEstadoEspecialista="";mostrarHistoria=new C;set usuario(i){this._usuario=i,this.mensajeEstadoEspecialista=i?.habilitado?"Deshabilitar":"Habilitar"}get id(){return this._usuario?.id}get esAdmin(){return this.permisos.datos?.tipo=="admin"}get nombre(){return this._usuario?.nombre}get apellido(){return this._usuario?.apellido}get dni(){return this._usuario?.dni}get email(){return this._usuario?.email}get edad(){return this._usuario?.edad}get imagen1(){return this._usuario?.imagen1}get imagen2(){return this._usuario?.imagen2}get tipo(){return this._usuario?.tipo}get especialidades(){return this._usuario?.especialidades}get obraSocial(){return this._usuario?.obraSocial}get habilitado(){return this._usuario?.habilitado}get mensaje(){return this._usuario?this._usuario.habilitado?"Deshabilitar":"Habilitar":""}cambiarEstado(){this.cargando=!0,this._usuario!=null&&this._usuario.tipo=="especialista"&&(this.db.cambiarEstado(this._usuario.id,!this._usuario.habilitado).then(()=>{this.cargando=!1}).catch(i=>console.log(i)),this._usuario.habilitado=!this._usuario.habilitado)}mostrarHistoriaClinica(){this.mostrarHistoria.emit(this._usuario)}descargarDatosTurnos(){if(this._usuario){this.cargando=!0;let i="turnos-"+this.dni,e=this.db.obtenerTurnosPaciente(this._usuario.id).subscribe(r=>{let d=this.formatearDatos(r),X=H.json_to_sheet(d),N={Sheets:{[i]:X},SheetNames:[i]},V=F(N,{bookType:"xlsx",type:"array"});this.generarArchivoExcel(V,`${i}.xlsx`),this.cargando=!1,e.unsubscribe()})}}formatearDatos(i){return i.map(e=>({id:e.id,tipo:e.tipo,fecha:new Date(new Date(e.fecha).getTime()-3*60*60*1e3).toISOString(),duracion:e.duracion,estado:O[e.estado],idPaciente:e.idPaciente,nombrePaciente:e.nombrePaciente,dniPaciente:e.dniPaciente,idEspecialista:e.idEspecialista,nombreEspecialista:e.nombreEspecialista,rese\u00F1a:e.resenia,encuesta:e.encuesta,calificacion:e.calificacion,mensajeCancelacion:e.mensajeCancelacion,altura:e.historiaClinica?.altura,peso:e.historiaClinica?.peso,temperatura:e.historiaClinica?.temperatura,presionMin:e.historiaClinica?.presionMin,presionMax:e.historiaClinica?.presionMax,clave1:e.historiaClinica?.dato1?.clave,valor1:e.historiaClinica?.dato1?.valor,clave2:e.historiaClinica?.dato2?.clave,valor2:e.historiaClinica?.dato2?.valor,clave3:e.historiaClinica?.dato3?.clave,valor3:e.historiaClinica?.dato3?.valor}))}generarArchivoExcel(i,e){let r=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),d=document.createElement("a");d.href=window.URL.createObjectURL(r),d.download=e,d.click(),setTimeout(()=>{window.URL.revokeObjectURL(d.href)},100)}static \u0275fac=function(e){return new(e||t)(v(P),v(j))};static \u0275cmp=h({type:t,selectors:[["app-detalle-usuario"]],inputs:{usuario:"usuario"},outputs:{mostrarHistoria:"mostrarHistoria"},standalone:!0,features:[S],decls:17,vars:14,consts:[[4,"ngIf"],[1,"contenedor-imagenes"],["class","imagen",4,"ngIf"],[3,"disabled","ngClass","click",4,"ngIf"],[3,"disabled","click",4,"ngIf"],["class","activo",3,"disabled","click",4,"ngIf"],[1,"br"],[4,"ngFor","ngForOf"],[3,"textContent"],[1,"imagen"],[1,"br","titulo-foto"],["alt","foto perfil",3,"src"],["alt","foto secundaria",3,"src"],[3,"click","disabled","ngClass"],[3,"click","disabled"],[1,"activo",3,"click","disabled"]],template:function(e,r){e&1&&(o(0,"label"),l(1,"Detalles de Usuario"),a(),m(2,R,5,1,"div",0)(3,z,5,1,"div",0)(4,W,6,3,"div",0)(5,$,5,1,"div",0)(6,q,5,1,"div",0)(7,G,5,1,"div",0)(8,J,5,1,"div",0)(9,Q,4,1,"div",0)(10,Y,4,1,"div",0),o(11,"div",1),m(12,Z,4,1,"div",2)(13,ee,4,1,"div",2),a(),m(14,te,2,5,"button",3)(15,ie,2,1,"button",4)(16,ae,2,1,"button",5)),e&2&&(n(2),s("ngIf",r.nombre),n(),s("ngIf",r.apellido),n(),s("ngIf",r.dni),n(),s("ngIf",r.tipo),n(),s("ngIf",r.edad),n(),s("ngIf",r.email),n(),s("ngIf",r.obraSocial),n(),s("ngIf",r.especialidades),n(),s("ngIf",r.especialidades),n(2),s("ngIf",r.imagen1),n(),s("ngIf",r.imagen2),n(),s("ngIf",r.esAdmin&&r.tipo=="especialista"),n(),s("ngIf",r.esAdmin&&r.tipo=="paciente"),n(),s("ngIf",r.esAdmin&&r.tipo=="paciente"))},dependencies:[M,w,U,k,T,L],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}label[_ngcontent-%COMP%]{display:inline-block;margin-bottom:5px;text-align:left;font-weight:700}p[_ngcontent-%COMP%]{display:inline-block;margin-left:10px;margin-bottom:0}.br[_ngcontent-%COMP%]{display:inline-block}div[_ngcontent-%COMP%]{width:100%;margin:10px;background-color:#f5f5f5;border-radius:20px;padding:8px 3px}.contenedor-imagenes[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;margin:10px;min-width:500px;background-color:#f5f5f5;border-radius:20px;padding:10px 15px 15px}.imagen[_ngcontent-%COMP%]{width:20%;aspect-ratio:1/1;text-align:center;margin:2px;background-color:#fff;border-radius:10px;border:1px solid black}.titulo-foto[_ngcontent-%COMP%]{font-size:14px}img[_ngcontent-%COMP%]{width:80%;aspect-ratio:1/1}button[_ngcontent-%COMP%]{width:80%;background-color:#48cc48;color:#fff;padding:10px;border-radius:10px;font-weight:700;border:1px solid black}button[_ngcontent-%COMP%]:disabled{background-color:gray;color:#fff}.activo[_ngcontent-%COMP%]{background-color:#dd4343}"]})};export{A as a};
