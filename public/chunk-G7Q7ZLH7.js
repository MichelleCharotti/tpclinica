import{a as B}from"./chunk-R47CQCFP.js";import{c as A,f as D,j as R,o as $}from"./chunk-TNGGSYNN.js";import{a as F}from"./chunk-JUPKOMRS.js";import{$ as O,C as c,D as C,H as x,I as d,K as r,L as s,N as f,O as _,P as p,U as l,V as h,W as v,X as T,Y as w,Z as S,_ as j,ab as P,ba as b,bb as L,ca as M,da as I,ma as k,na as H,p as E,pa as V,qa as z,s as y,u,v as m,xa as U}from"./chunk-CITMPR77.js";var g=class n{transform(e,...t){switch(e){case 0:return"pendiente";case 1:return"aceptado";case 4:return"cancelado";case 3:return"cancelado";case 2:return"cancelado";case 5:return"rechazado";case 1:return"aceptado";case 6:return"realizado";default:return"tipo dato invalido"}}static \u0275fac=function(t){return new(t||n)};static \u0275pipe=y({name:"estadoTurno",type:n,pure:!0,standalone:!0})};function q(n,e){n&1&&(r(0,"p"),l(1,"paciente"),s())}function G(n,e){n&1&&(r(0,"p"),l(1,"dni"),s())}function J(n,e){n&1&&(r(0,"p"),l(1,"especialista"),s())}function K(n,e){if(n&1&&(r(0,"p"),l(1),s()),n&2){let t=p().$implicit;c(),h(t.nombrePaciente)}}function Q(n,e){if(n&1&&(r(0,"p"),l(1),b(2,"dniFormato"),s()),n&2){let t=p().$implicit;c(),h(M(2,1,t.dniPaciente))}}function X(n,e){if(n&1&&(r(0,"p"),l(1),s()),n&2){let t=p().$implicit;c(),h(t.nombreEspecialista)}}function Z(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.cancelarTurno(a))}),l(1,"Cancelar"),s()}}function ee(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.rechazarTurno(a))}),l(1,"Rechazar"),s()}}function te(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.aceptarTurno(a))}),l(1,"Aceptar"),s()}}function ie(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.finalizarTurno(a))}),l(1,"Finalizar"),s()}}function ne(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.verResenia(a))}),l(1,"Rese\xF1a"),s()}}function oe(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.verCalificacion(a))}),l(1,"Calificacion"),s()}}function ae(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.calificarAtencion(a))}),l(1,"Calificar Atencion"),s()}}function re(n,e){if(n&1){let t=f();r(0,"button",13),_("click",function(){u(t);let a=p().$implicit,o=p();return m(o.verCancelacion(a))}),l(1,"Ver Motivo"),s()}}function se(n,e){if(n&1&&(r(0,"p",14),l(1),s()),n&2){let t=p().$implicit,i=p();c(),v(" Turno Cancelado Por ",t.estado==i.estados.canceladoPaciente?"Paciente":t.estado==i.estados.canceladoEspecialista?"Especialita":"Administracion"," ")}}function ce(n,e){n&1&&(r(0,"p",14),l(1," Turno Rechazado Por Especialista "),s())}function le(n,e){if(n&1&&(r(0,"div",8),x(1,K,2,1,"p",5)(2,Q,3,3,"p",5)(3,X,2,1,"p",5),r(4,"p"),l(5),s(),r(6,"p"),l(7),b(8,"date"),s(),r(9,"p",9),l(10),b(11,"estadoTurno"),s(),r(12,"div",10),x(13,Z,2,0,"button",11)(14,ee,2,0,"button",11)(15,te,2,0,"button",11)(16,ie,2,0,"button",11)(17,ne,2,0,"button",11)(18,oe,2,0,"button",11)(19,ae,2,0,"button",11)(20,re,2,0,"button",11)(21,se,2,1,"p",12)(22,ce,2,0,"p",12),s()()),n&2){let t=e.$implicit,i=p();c(),d("ngIf",i.tipoUser!="paciente"),c(),d("ngIf",i.tipoUser!="paciente"),c(),d("ngIf",i.tipoUser!="especialista"),c(2),h(t.tipo),c(2),h(I(8,16,t.fecha,"d/MM HH:mm","-0300")),c(3),v(" ",M(11,20,t.estado)," "),c(3),d("ngIf",t.estado==i.estados.pendiente||i.tipoUser=="paciente"&&t.estado==i.estados.aceptado),c(),d("ngIf",t.estado==i.estados.pendiente&&i.tipoUser=="especialista"),c(),d("ngIf",t.estado==i.estados.pendiente&&i.tipoUser=="especialista"),c(),d("ngIf",t.estado==i.estados.aceptado&&i.tipoUser=="especialista"),c(),d("ngIf",t.resenia&&i.tipoUser!="admin"),c(),d("ngIf",t.calificacion&&i.tipoUser!="admin"),c(),d("ngIf",t.estado==i.estados.realizado&&i.tipoUser=="paciente"&&!t.calificacion),c(),d("ngIf",t.estado>1&&t.estado<5||t.estado==i.estados.rechazado),c(),d("ngIf",t.estado>1&&t.estado<5),c(),d("ngIf",t.estado==i.estados.rechazado)}}function pe(n,e){if(n&1){let t=f();r(0,"div",17)(1,"p"),l(2),s(),r(3,"textarea",18),S("ngModelChange",function(a){u(t);let o=p(2);return w(o.respuestaUsuario,a)||(o.respuestaUsuario=a),m(a)}),s(),r(4,"button",19),_("click",function(){u(t);let a=p(2);return m(a.finalizarMensaje())}),l(5,"Ok"),s(),r(6,"button",19),_("click",function(){u(t);let a=p(2);return m(a.cancelarMensaje())}),l(7,"Cancelar"),s()()}if(n&2){let t=p(2);c(2),h(t.mensaje),c(),T("ngModel",t.respuestaUsuario)}}function de(n,e){if(n&1){let t=f();r(0,"div",17)(1,"p"),l(2),s(),r(3,"button",19),_("click",function(){u(t);let a=p(2);return m(a.cancelarMensaje())}),l(4,"Ok"),s()()}if(n&2){let t=p(2);c(2),h(t.mensaje)}}function ue(n,e){if(n&1&&(r(0,"div",15),x(1,pe,8,2,"div",16)(2,de,5,1,"div",16),s()),n&2){let t=p();c(),d("ngIf",t.tipoMensaje),c(),d("ngIf",!t.tipoMensaje)}}var N=class n{constructor(e,t,i){this.usuario=e;this.db=t;this.estadoPipe=i;this.usuario.datos?.tipo=="admin"?this.subTurnos=this.db.obtenerTurnosAdmin().subscribe(a=>{this._turnos=a,this.obtenerOpciones(),this.filtrarTurnos()}):this.usuario.datos?.tipo=="paciente"?this.subTurnos=this.db.obtenerTurnosPaciente(this.usuario.datos.id).subscribe(a=>{this._turnos=a,this.obtenerOpciones(),this.filtrarTurnos()}):this.usuario.datos?.tipo=="especialista"?this.subTurnos=this.db.obtenerTurnosEspecialista(this.usuario.datos.id).subscribe(a=>{this._turnos=a,this.obtenerOpciones(),this.filtrarTurnos()}):this.subTurnos=this.db.obtenerTurnosAdmin().subscribe(a=>{this._turnos=a,this.obtenerOpciones(),this.filtrarTurnos()})}_turnos;turnos;especialistas;especialidades;pacientes;especialidadSeleccionada="";especialistaSeleccionado="";pacienteSeleccionado="";filtro="";subTurnos;estados=P;mensaje="";tipoMensaje;respuestaUsuario="";turnoSeleccionado;get tipoUser(){return this.usuario.datos?.tipo}ngDestroy(){this.subTurnos&&this.subTurnos.unsubscribe()}filtrarTurnos(){this.turnos=[];let e=this.filtro.trim().toLowerCase().split(" ");if(this._turnos)for(let t of this._turnos)if(this.filtro!="")this.compararTurnos(t,e)&&this.turnos.push(t);else{this.turnos=this._turnos;break}}compararTurnos(e,t){let i=new Date(e.fecha);i.setHours(i.getHours()-3);let a=i.toISOString();for(let o of t)if(o=o.toLowerCase(),!e.nombrePaciente.toLowerCase().includes(o)&&!e.nombreEspecialista.toLowerCase().includes(o)&&!e.dniPaciente.toLowerCase().includes(o)&&!e.tipo.toLowerCase().includes(o)&&!e.historiaClinica?.altura.toString().includes(o)&&!e.historiaClinica?.temperatura.toString().includes(o)&&!e.historiaClinica?.peso.toString().includes(o)&&!e.historiaClinica?.presionMax.toString().includes(o)&&!e.historiaClinica?.presionMin.toString().includes(o)&&!e.historiaClinica?.dato1?.clave.toLowerCase().includes(o)&&!e.historiaClinica?.dato1?.valor.toLowerCase().includes(o)&&!e.historiaClinica?.dato2?.clave.toLowerCase().includes(o)&&!e.historiaClinica?.dato2?.valor.toLowerCase().includes(o)&&!e.historiaClinica?.dato3?.clave.toLowerCase().includes(o)&&!e.historiaClinica?.dato3?.valor.toLowerCase().includes(o)&&!this.estadoPipe.transform(e.estado).toLowerCase().includes(o)&&!this.compararFecha(a,o))return!1;return!0}compararFecha(e,t){e=e.replace(/-/g,"/"),e=e.slice(0,16);let i=t.split("/");return t=i.length==1?i[0]:(i[1]=="0"?"":i[1])+"/"+(i[0]=="0"?"":i[0]),console.log(e," | ",t),e.includes(t)}obtenerOpciones(){this.obtenerEspecialidades(),this.usuario.datos?.tipo=="especialista"?this.obtenerPacientes():this.obtenerEspecialistas()}obtenerPacientes(){if(this.pacientes=[],this._turnos)for(let e of this._turnos){let t={id:e.idPaciente,nombre:e.nombrePaciente};this.existe(this.pacientes,t.id)||this.pacientes.push(t)}}existe(e,t){for(let i of e)if(i.id==t)return!0;return!1}obtenerEspecialidades(){if(this.especialidades=[],this._turnos)for(let e of this._turnos)this.especialidades.includes(e.tipo)||this.especialidades.push(e.tipo)}obtenerEspecialistas(){if(this.especialistas=[],this._turnos)for(let e of this._turnos){let t={id:e.idEspecialista,nombre:e.nombreEspecialista};this.existe(this.especialistas,t.id)||this.especialistas.push(t)}}seleccionarEspecialidad(e){this.especialidadSeleccionada==e?this.especialidadSeleccionada="":(this.especialidadSeleccionada=e,this.especialistaSeleccionado="",this.pacienteSeleccionado=""),this.filtrarTurnos()}seleccionarPaciente(e){this.pacienteSeleccionado==e?this.pacienteSeleccionado="":(this.pacienteSeleccionado=e,this.especialistaSeleccionado="",this.especialidadSeleccionada=""),this.filtrarTurnos()}seleccionarEspecialista(e){this.especialistaSeleccionado==e?this.especialistaSeleccionado="":(this.especialistaSeleccionado=e,this.especialidadSeleccionada="",this.pacienteSeleccionado=""),this.filtrarTurnos()}cancelarTurno(e){this.mensaje="Ingrese motivo de la cancelacion",this.tipoUser=="paciente"?this.tipoMensaje=2:this.tipoUser=="especialista"?this.tipoMensaje=3:this.tipoMensaje=4,this.turnoSeleccionado=e}rechazarTurno(e){this.mensaje="Ingrese motivo del rechazo",this.tipoMensaje=5,this.turnoSeleccionado=e}aceptarTurno(e){this.db.actualizarEstadoTurno(e,1)}finalizarTurno(e){this.turnoSeleccionado=e}cancelarMensaje(){this.mensaje="",this.tipoMensaje=void 0}finalizarMensaje(){this.turnoSeleccionado&&(this.tipoMensaje?(this.db.actualizarEstadoTurno(this.turnoSeleccionado,this.tipoMensaje),this.tipoMensaje==6?this.db.agregarMensajeReseniaTurno(this.turnoSeleccionado,this.respuestaUsuario):(this.tipoMensaje==4||this.tipoMensaje==2||this.tipoMensaje==3)&&this.db.agregarMensajeCancelacionTurno(this.turnoSeleccionado,this.respuestaUsuario)):this.db.agregarMensajeCalificacionTurno(this.turnoSeleccionado,this.respuestaUsuario)),this.mensaje="",this.respuestaUsuario="",this.tipoMensaje=void 0}verResenia(e){this.mensaje=e.resenia?e.resenia:""}verCalificacion(e){this.mensaje=e.calificacion?e.calificacion:""}verCancelacion(e){console.log(e),this.mensaje=e.mensajeCancelacion?e.mensajeCancelacion:""}calificarAtencion(e){this.mensaje="Ingrese calificacion de la Atencion",this.turnoSeleccionado=e}static \u0275fac=function(t){return new(t||n)(C(F),C(L),C(g))};static \u0275cmp=E({type:n,selectors:[["app-historial-turnos"]],standalone:!0,features:[j([g]),O],decls:24,vars:6,consts:[[1,"contendor-info"],[1,"titulo"],[1,"opciones"],["placeholder","Ingrese datos...","type","text",3,"ngModelChange","input","ngModel"],[1,"datos","head"],[4,"ngIf"],["class","datos",4,"ngFor","ngForOf"],["class","pantalla-completa",4,"ngIf"],[1,"datos"],[1,"estado"],[1,"botones-estado"],["class","cambiar-estado",3,"click",4,"ngIf"],["class","cancelado",4,"ngIf"],[1,"cambiar-estado",3,"click"],[1,"cancelado"],[1,"pantalla-completa"],["class","mensaje",4,"ngIf"],[1,"mensaje"],["type","text","placeholder","Mensaje...",1,"respuesta",3,"ngModelChange","ngModel"],[3,"click"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"h3"),l(2,"Historial Turnos"),s(),r(3,"div",1)(4,"h4"),l(5,"Filtrar Datos"),s(),r(6,"div",2)(7,"input",3),S("ngModelChange",function(o){return w(i.filtro,o)||(i.filtro=o),o}),_("input",function(){return i.filtrarTurnos()}),s()()(),r(8,"div",1)(9,"div")(10,"h4"),l(11,"Turnos"),s(),r(12,"div",4),x(13,q,2,0,"p",5)(14,G,2,0,"p",5)(15,J,2,0,"p",5),r(16,"p"),l(17,"tipo"),s(),r(18,"p"),l(19,"fecha"),s(),r(20,"p"),l(21,"estado"),s()(),x(22,le,23,22,"div",6),s()()(),x(23,ue,3,2,"div",7)),t&2&&(c(7),T("ngModel",i.filtro),c(6),d("ngIf",i.tipoUser!="paciente"),c(),d("ngIf",i.tipoUser!="paciente"),c(),d("ngIf",i.tipoUser!="especialista"),c(7),d("ngForOf",i.turnos),c(),d("ngIf",i.mensaje))},dependencies:[U,z,k,H,V,$,A,D,R,g,B],styles:["[_nghost-%COMP%]{display:flex;align-items:center;flex-direction:column}input[_ngcontent-%COMP%]{width:50vw}button[_ngcontent-%COMP%]{margin:5px;width:200px;padding:2px 0;border:none;border-radius:5px;font-size:1rem;font-weight:700;text-transform:capitalize;cursor:pointer}.activo[_ngcontent-%COMP%]{background-color:#3485c3;color:#fff}.titulo[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;max-height:65vh}.opciones[_ngcontent-%COMP%]{background-color:#f5f5f5;display:flex;align-items:center;justify-content:center;flex-wrap:wrap;max-height:50vh;max-width:80vw;padding:5px;border-radius:10px;border:1px solid grey;overflow-y:auto}.datos[_ngcontent-%COMP%]{display:flex;border:1px solid black;margin:5px 0;padding:0 10px;border-radius:10px;flex-direction:row;width:85vw;justify-content:left;align-items:center;font-size:.75vw}.estado[_ngcontent-%COMP%]{background-color:#f5f5f5;text-align:center;font-weight:700;width:80px;font-size:.65vw;margin-right:15px;padding:10px 0;border-radius:5px}.cambiar-estado[_ngcontent-%COMP%]{font-size:.65vw;font-weight:700;width:auto;padding:5px 10px}p[_ngcontent-%COMP%]{margin:0;width:180px;text-transform:capitalize}.head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;font-weight:bolder}.botones-estado[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.botones-estado[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:120px;font-size:.65vw;font-weight:700}.mensaje[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:400px;background-color:#f5f5f5;border-radius:25px;border:1px solid black}.mensaje[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:20px;font-weight:700;text-align:center}.mensaje[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:60%;margin:10px;border-radius:10px;background-color:#3485c3;color:#fff}.mensaje[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2f75aa}.pantalla-completa[_ngcontent-%COMP%]{position:absolute;display:flex;justify-content:center;align-items:center;top:0%;width:100vw;height:100vh;background-color:#3485c333}.respuesta[_ngcontent-%COMP%]{width:400px;height:400px;resize:none}.cancelado[_ngcontent-%COMP%]{width:300px;font-weight:bolder}[_nghost-%COMP%], .contenedor-info[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInAnimation 1s ease forwards}@keyframes _ngcontent-%COMP%_slideInAnimation{0%{opacity:0;transform:translateY(200%)}to{opacity:1;transform:translateY(0)}}.historia[_ngcontent-%COMP%]{background-color:#f5f5f5;border:2px solid grey;border-radius:15px;margin:10px 0;padding:5px 10px 0}p[_ngcontent-%COMP%], h2[_ngcontent-%COMP%]{text-transform:capitalize}h3[_ngcontent-%COMP%]{text-align:center}.contenedor-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}"]})};export{N as HistorialTurnosComponent};
